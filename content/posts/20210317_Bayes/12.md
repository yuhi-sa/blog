---
title: マルコフ連鎖モンテカルロ法(MCMC)
date: 2021-03-18T11:00:23+09:00
draft: false
tags: ["しくみがわかるベイズ統計と機械学習"] 
---
<!--more-->
# マルコフ性とマルコフ連鎖
時刻$t$が1,2,3という離散的な値であり，それぞれにそれぞれに$x^{(1)},x^{(2)},x^{(3)}$という確率変数を持つ系列を考える．

- マルコフ連鎖：$x^{(1)},x^{(2)},x^{(3)}$の確率変数を決めていくシステム
- マルコフ性：現在の状態は，直近の状態によってのみ決まる．
  - 1次マルコフ性:$x^{(t)}$の状態は$x^{(t-1)}$のみによって決まる．
  - $n$次マルコフ性：$x^{(t)}$の状態は$x^{(t-1)},...,x^{(t-n)}$のみによって決まる．
- 遷移確率$p(x^{(t)}|x^{(t-1)})$：時刻$t-1$の状態から時刻$t$の状態に遷移する確率
- 定常分布$\pi$：遷移前の状態を$x$,遷移後の状態を$y$として以下の性質(定常性)が成り立つ分布．
  $\pi(y)=\sum_x p(y|x)\pi(x)$

# マルコフ連鎖モンテカルロ法(MCMC)
MCMCでは遷移確率$p(y|x)$を使って，標本の系列$x^{(1)},x^{(2)},...$を作成する．MCMCで作成される標本のうち，最初の方は初期値への依存性が強ういため，$t$を十分に大きな数として$x^{(t)}$以降を使用する．
MCMCで広く使われている方法が，メトロポリス・ヘイスティングス法である．

## メトロポリス・ヘイスティング法
$t=1$と設定し，$x^{(1)}$を初期分布$p_1(x)$からサンプリング後，以下を繰り返す．
1. 提案分布$q(\hat{y}|x^{(t)}$に従って標本候補$\hat{y}$を得る．
2. 確率$\alpha(x^{(t)},\hat{y})$で標本候補$\hat{y}$を標本候補$\hat{y}$を$x^{(t+1)}$として採択する．
   
   $$\alpha(x^{(t)},\hat{y})=\min(\frac{q(x^{(t)}|\hat{y})b(\hat{y})}{q(\hat{y}|x^{(t)})b(x^{(t)})},1)$$

3. $t=t+1$

# 参考
- 手塚 太郎，"[しくみがわかるベイズ統計と機械学習](https://amzn.to/3cCILQM)"